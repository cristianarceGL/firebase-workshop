<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE en-export SYSTEM "http://xml.evernote.com/pub/evernote-export3.dtd">
<en-export export-date="20200317T213754Z" application="Evernote" version="Evernote Mac 7.14 (458244)">
<note><title>Firebase Workshop Session#2 March-2020</title><content><![CDATA[<!DOCTYPE en-note SYSTEM "http://xml.evernote.com/pub/enml2.dtd"><en-note><div><span title="Page 1" style="-en-paragraph:true;"><span style="font-size: 18px; color: rgb(169, 169, 169); font-family: Arial; font-style: italic;">Firebase workshop by Cristian Arce &amp; Alfredo Bonilla
</span></span></div><hr /><div><span style="font-size: 36px; color: rgb(72, 177, 65); font-family: Arial; font-weight: bold;">Session #2</span></div><div><span style="font-size: 24px; caret-color: rgb(72, 177, 65);"><br /></span></div><div><span style="caret-color: rgb(72, 177, 65); font-size: 24px;"><span style="font-size: 24px; color: rgb(72, 177, 65); font-family: Arial; font-weight: bold;">Firebase Databases</span></span></div><div><span style="caret-color: rgb(72, 177, 65); font-size: 24px;"><br /></span></div><div><font style="font-size: 18px;"><span style="font-size: 18px; font-family: Arial; font-weight: bold;">Step 1:</span><span style="font-size: 18px; font-family: Arial;"> </span></font><span style="font-size: 18px; font-family: Arial;"> Navigate to </span><a href="https://firebase.google.com/" style="font-size: 18px; font-family: Arial;">https://firebase.google.com/</a>, <span style="font-size: 18px; font-family: Arial;">look for the Database options, and access rules for both </span><span style="font-size: 18px; font-family: Arial; font-weight: bold;">Cloud Firestore</span><span style="font-size: 18px; font-family: Arial;"> and </span><span style="font-size: 18px; font-family: Arial; font-weight: bold;">Realtime Database</span></div><div><font face="Arial" style="font-size: 18px;"><br /></font></div><div><span style="font-size: 18px; font-family: Arial;">When the project was created, the selected schema was </span><span style="font-size: 18px; font-family: Arial; font-weight: bold;">production</span><span style="font-size: 18px; font-family: Arial;">, so, the database can not be accessed without authentication; therefore it is required to add the authentication for </span><span style="font-size: 18px; font-family: Arial; font-weight: bold;">read/write</span></div><div><font face="Arial" style="font-size: 18px;"><br /></font></div><div><font face="Arial" style="font-size: 18px;"><span style="font-size: 18px; font-family: Arial; font-weight: bold;">Cloud Firestore</span></font></div><div><font face="Arial" style="font-size: 18px;"><br /></font></div><div><span style="font-size: 18px; font-family: Arial;">Override the current rules using:</span></div><div><font face="Arial" style="font-size: 18px;"><br /></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div><font style="font-size: 18px;">rules_version = '2';</font></div><div><font style="font-size: 18px;">service cloud.firestore {</font></div><div><font style="font-size: 18px;">  match /databases/{database}/documents {</font></div><div><font style="font-size: 18px;">    match /{document=**} {</font></div><div><font style="font-size: 18px;">      allow read, write: if request.auth != null;</font></div><div><font style="font-size: 18px;">    }</font></div><div><font style="font-size: 18px;">  }</font></div><div><font style="font-size: 18px;">}</font></div></div><div><font face="Arial" style="font-size: 18px;"><br /></font></div><div><span style="font-size: 18px; font-family: Arial; font-weight: bold;">Realtime Database</span></div><div><br /></div><div><span style="font-size: 18px; font-family: Arial;">Override the current rules using:</span></div><div><font face="Arial" style="font-size: 18px;"><br /></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div><font style="font-size: 18px;">// These rules grant access to a node matching the authenticated</font></div><div><font style="font-size: 18px;">// user's ID from the Firebase auth token</font></div><div><font style="font-size: 18px;">{</font></div><div><font style="font-size: 18px;">  "rules": {</font></div><div><font style="font-size: 18px;">    "user": {</font></div><div><font style="font-size: 18px;">      ".read": "auth.uid != null",</font></div><div><font style="font-size: 18px;">      ".write": "auth.uid != null"</font></div><div><font style="font-size: 18px;">    }</font></div><div><font style="font-size: 18px;">  }</font></div><div><font style="font-size: 18px;">}</font></div></div><div><span style="font-size: 18px;"><br /></span></div><div><br /></div><div><span style="font-size: 18px; font-family: Arial; font-weight: bold;">Step 2:</span><span style="font-size: 18px; font-family: Arial;"> Clone the base project from repo in a folder</span></div><div><br /></div><div style="background-color: rgb(241, 243, 244); padding: 24px 40px; overflow-x: auto; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="background-color: rgb(241, 243, 244); overflow-x: auto; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 18px; color: rgb(55, 71, 79); font-family: &quot;Roboto Mono&quot;, monospace; font-stretch: normal; font-variant-caps: normal; line-height: 20px;">$</span><span style="background-color:rgb(241, 243, 244);color:rgb(0, 0, 0);font-family:Times;font-size:medium;font-variant-caps:normal;font-variant-ligatures:normal;"><span style="color: rgb(55, 71, 79); font-family: &quot;Roboto Mono&quot;, monospace; font-size: 18px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 243, 244); overflow-x: auto; font-stretch: normal; line-height: 20px;"> </span><span style="color: rgb(55, 71, 79); font-family: &quot;Roboto Mono&quot;; font-size: 18px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 243, 244); overflow-x: auto;">git clone </span><a href="mailto:git@github.com" style="color: rgb(55, 71, 79); font-family: &quot;Roboto Mono&quot;; font-size: 18px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 243, 244); overflow-x: auto;">git@github.com</a><span style="color: rgb(55, 71, 79); font-family: &quot;Roboto Mono&quot;; font-size: 18px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 243, 244); overflow-x: auto;">:cristianarceGL/firebase-workshop.git</span></span></div><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 243, 244); padding: 24px 40px; overflow-x: auto;"><span style="color: rgb(55, 71, 79); font-family: &quot;Roboto Mono&quot;, monospace; font-size: 18px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 243, 244); overflow-x: auto; font-stretch: normal; line-height: 20px;">$ cd </span><span style="color: rgb(55, 71, 79); font-family: &quot;Roboto Mono&quot;; font-size: 18px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 243, 244); overflow-x: auto;">firebase-workshop</span></div><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 243, 244); padding: 24px 40px; overflow-x: auto;"><span style="color: rgb(55, 71, 79); font-family: &quot;Roboto Mono&quot;, monospace; font-size: 18px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 243, 244); overflow-x: auto; font-stretch: normal; line-height: 20px;">$ </span><span style="color: rgb(55, 71, 79); font-family: &quot;Roboto Mono&quot;; font-size: 18px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 243, 244); overflow-x: auto;">git checkout Session2-Base</span></div><div style="color: rgb(0, 0, 0); font-family: Times; font-size: medium; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 243, 244); padding: 24px 40px; overflow-x: auto;"><span style="color: rgb(55, 71, 79); font-family: &quot;Roboto Mono&quot;, monospace; font-size: 18px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 243, 244); overflow-x: auto; font-stretch: normal; line-height: 20px;">$ </span><span style="color: rgb(55, 71, 79); font-family: &quot;Roboto Mono&quot;; font-size: 18px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 243, 244); overflow-x: auto;">git pull</span></div><div><br /></div><div><br /></div><div><span style="font-size: 18px;">After pulling the repo, it is mandatory to install all dependencies and run the app</span></div><div><br /></div><div style="background-color: rgb(241, 243, 244); padding: 24px 40px; overflow-x: auto; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="background-color: rgb(241, 243, 244); overflow-x: auto; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 18px; color: rgb(55, 71, 79); font-family: &quot;Roboto Mono&quot;, monospace; font-stretch: normal; font-variant-caps: normal; line-height: 20px;">$ </span><span style="background-color: rgb(241, 243, 244); overflow-x: auto; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 18px; color: rgb(55, 71, 79); font-family: &quot;Roboto Mono&quot;, monospace; font-stretch: normal; font-variant-caps: normal; line-height: 20px;">npm install &amp;&amp; npm start</span></div><div><br /></div><div><br /></div><div><span style="font-size: 18px; font-family: Arial;">After running this, open the browser using the url</span><span style="font-size: 18px; font-family: Arial; font-weight: bold;">  </span><a href="http://localhost:4200/login" style="font-size: 18px; font-family: Arial; font-weight: bold;">http://localhost:4200/</a><span style="font-size: 18px; font-family: Arial;">, a login page must be displayed, that’s the one we will be modifying from now</span></div><div><br /></div><div><span style="font-size: 18px;"><br /></span></div><div><span style="font-size: 18px; font-family: Arial; font-weight: bold;">Step 3:</span><span style="font-size: 18px; font-family: Arial;"> Create a folder </span><span style="font-size: 18px; font-family: Arial; font-weight: bold;">src/data</span><span style="font-size: 18px; font-family: Arial;"> and create a json file </span><span style="font-size: 18px; font-family: Arial; font-weight: bold;">firebase-workshop-realtime.json</span><span style="font-size: 18px; font-family: Arial;">, and add this content:</span></div><div><span style="font-size: 18px;"><br /></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div><font style="font-size: 18px;">{</font></div><div><font style="font-size: 18px;">    "user": {</font></div><div><font style="font-size: 18px;">        "YmiEtwanKzfGImufwGLw": {</font></div><div><div><font style="font-size: 18px;">            "address": "San José",</font></div></div><div><div><font style="font-size: 18px;">            "cellphone": 50688881111,</font></div></div><div><div><font style="font-size: 18px;">            "displayName": "Angular User",</font></div></div><div><div><font style="font-size: 18px;">            "email": "angular@angular.com",</font></div></div><div><div><font style="font-size: 18px;">            "phoneNumber": 50688881111,</font></div></div><div><div><font style="font-size: 18px;">            "photoURL": "",</font></div></div><div><div><font style="font-size: 18px;">            "uid": "fb-uid-Ng",</font></div></div><div><div><font style="font-size: 18px;">            "id": "YmiEtwanKzfGImufwGLw"</font></div></div><div><font style="font-size: 18px;">        },</font></div><div><font style="font-size: 18px;">        "hWK2l08gjkyqhyH37zsmrw": {</font></div><div><div><font style="font-size: 18px;">            "address": "Alajuela",</font></div></div><div><div><font style="font-size: 18px;">            "cellphone": 50688882222,</font></div></div><div><div><font style="font-size: 18px;">            "displayName": "React User",</font></div></div><div><div><font style="font-size: 18px;">            "email": "react@react.com",</font></div></div><div><div><font style="font-size: 18px;">            "phoneNumber": 50688882222,</font></div></div><div><div><font style="font-size: 18px;">            "photoURL": "",</font></div></div><div><div><font style="font-size: 18px;">            "uid": "fb-uid-React",</font></div></div><div><div><font style="font-size: 18px;">            "id": "hWK2l08gjkyqhyH37zsmrw"</font></div></div><div><font style="font-size: 18px;">        },</font></div><div><font style="font-size: 18px;">        "6Z1hUjQDKkKvdhZhts0": {</font></div><div><div><font style="font-size: 18px;">            "address": "Cartago",</font></div></div><div><div><font style="font-size: 18px;">            "cellphone": 50688883333,</font></div></div><div><div><font style="font-size: 18px;">            "displayName": "JQuery User",</font></div></div><div><div><font style="font-size: 18px;">            "email": "jquery@jquery.com",</font></div></div><div><div><font style="font-size: 18px;">            "phoneNumber": 50688883333,</font></div></div><div><div><font style="font-size: 18px;">            "photoURL": "",</font></div></div><div><div><font style="font-size: 18px;">            "uid": "fb-uid-Jquery",</font></div></div><div><div><font style="font-size: 18px;">            "id": "6Z1hUjQDKkKvdhZhts0"</font></div></div><div><font style="font-size: 18px;">        },</font></div><div><font style="font-size: 18px;">        "UtrLZibdgUK5RV": {</font></div><div><div><font style="font-size: 18px;">            "address": "Heredia",</font></div></div><div><div><font style="font-size: 18px;">            "cellphone": 50688884444,</font></div></div><div><div><font style="font-size: 18px;">            "displayName": "VueJs User",</font></div></div><div><div><font style="font-size: 18px;">            "email": "vue@vue.com",</font></div></div><div><div><font style="font-size: 18px;">            "phoneNumber": 50688884444,</font></div></div><div><div><font style="font-size: 18px;">            "photoURL": "",</font></div></div><div><div><font style="font-size: 18px;">            "uid": "fb-uid-Vue",</font></div></div><div><div><font style="font-size: 18px;">            "id": "UtrLZibdgUK5RV"</font></div></div><div><font style="font-size: 18px;">        }</font></div><div><font style="font-size: 18px;">    }</font></div><div><font style="font-size: 18px;">}</font></div><div><div><br /></div></div></div><div><br /></div><div><br /></div><div><br /></div><hr /><div><font face="Arial" style="font-size: 18px;"><br /></font></div><div><font face="Arial" style="font-size: 18px;"><br /></font></div><div><span style="caret-color: rgb(72, 177, 65); font-size: 24px;"><span style="font-size: 24px; color: rgb(72, 177, 65); font-family: Arial; font-weight: bold;">Angular Project</span></span></div><div><span style="caret-color: rgb(72, 177, 65); font-size: 24px;"><br /></span></div><div><span style="font-size: 18px; font-family: Arial;">It is necessary now to update the </span><span style="font-size: 18px; font-family: Arial; font-style: italic; font-weight: bold;">admin-user.component.ts</span><span style="font-size: 18px; font-family: Arial;"> file with the firebase references</span></div><div><span style="font-size: 18px;"><br /></span></div><div><span style="font-size: 18px; font-family: Arial; font-weight: bold;">Step 1:</span><span style="font-size: 18px; font-family: Arial;"> </span><span style="font-size: 18px; font-family: Arial;"> </span><span style="font-size: 18px; font-family: Arial;">First, a new import for the user service at the top of the component</span></div><div><span style="font-size: 18px;"><br /></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div><font style="font-size: 18px;">... </font></div><div><font style="font-size: 18px;"><br /></font></div><div><font style="font-size: 18px;">import { UserService } from './admin-user.service';</font></div><div><font style="font-size: 18px;"><br /></font></div><div><font style="font-size: 18px;">... </font></div></div><div><br /></div><div><span style="font-size: 18px;"><br /></span></div><div><span style="font-size: 18px; font-family: Arial; font-weight: bold;">Step 2:</span><span style="font-size: 18px; font-family: Arial;"> </span><span style="font-size: 18px; font-family: Arial;"> Then the constructor is overridden for including the new user service, which has the access to Firebase modules for accessing the database</span></div><div><span style="font-size: 18px;"><br /></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div><div><font style="font-size: 18px;">... </font></div><div><font style="font-size: 18px;"><br /></font></div><div><font style="font-size: 18px;">constructor(private userService: UserService, public dialog: MatDialog, private subService: SubscriptionService) {}</font></div><div><font style="font-size: 18px;"><br /></font></div></div><div><font style="font-size: 18px;">...</font></div></div><div><span style="font-size: 18px;"><br /></span></div><div><span style="font-size: 18px; font-family: Arial; font-weight: bold;">Step 3:</span><span style="font-size: 18px; font-family: Arial;"> </span><span style="font-size: 18px; font-family: Arial;"> </span><span style="font-size: 18px; font-family: Arial;">It is required to override the ngOnInit, for getting the list of user from user service, and that response will fill up the datasource:</span></div><div><span style="font-size: 18px;"><br /></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div><div><font style="font-size: 18px;">public ngOnInit(): void {</font></div></div><div><font style="font-size: 18px;">    this.userService</font></div><div><font style="font-size: 18px;">        .getUserList()</font></div><div><font style="font-size: 18px;">        .pipe(takeUntil(this.subService.unsubscribe$))</font></div><div><div><font style="font-size: 18px;">        .subscribe(data =&gt; {</font></div></div><div><div><font style="font-size: 18px;">            const users = data.map(element =&gt; {</font></div></div><div><div><font style="font-size: 18px;">                return this.convertToUser(element);</font></div></div><div><font style="font-size: 18px;">            });</font></div><div><div><font style="font-size: 18px;">            this.dataSource = new MatTableDataSource(users);</font></div></div><div><font style="font-size: 18px;">        });</font></div><div><font style="font-size: 18px;">}</font></div></div><div><br /></div><div><br /></div><div><span style="font-size: 18px; font-family: Arial; font-weight: bold;">Step 4:</span><span style="font-size: 18px; font-family: Arial;"> </span><span style="font-size: 18px; font-family: Arial;"> </span><span style="font-size: 18px; font-family: Arial;">Now that the reference to Firebase is alive, we can execute CRUD operations; for this workshop proposes, we are overriding</span><span style="font-size: 18px; font-family: Arial;"> also </span><span style="font-size: 18px; font-family: Arial; font-weight: bold;">update</span><span style="font-size: 18px; font-family: Arial;"> and </span><span style="font-size: 18px; font-family: Arial; font-weight: bold;">delete</span><span style="font-size: 18px; font-family: Arial;"> as follow:</span></div><div><br /></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div><div><font style="font-size: 18px;">public updateUser(user: User) {</font></div></div><div><font style="font-size: 18px;">    this.userService.updateUser(user);</font></div><div><font style="font-size: 18px;">}</font></div><div><div><font style="font-size: 18px;"><br /></font></div></div><div><div><font style="font-size: 18px;">public deleteUser(user: User): void {</font></div></div><div><font style="font-size: 18px;">    this.userService.deleteUser(user.id);</font></div><div><font style="font-size: 18px;">}</font></div></div><div><br /></div><div><br /></div><div><span style="font-size: 18px; font-family: Arial; font-weight: bold;">Step 5:</span><span style="font-size: 18px; font-family: Arial;"> </span><span style="font-size: 18px; font-family: Arial;"> </span><span style="font-size: 18px; font-family: Arial;">The steps above would cause an error since the user service is not defined yet, so in </span><span style="font-size: 18px; font-family: Arial; font-weight: bold;">src/features/admin-user</span><span style="font-size: 18px; font-family: Arial;"> a new file is created as </span><span style="font-size: 18px; font-family: Arial; font-weight: bold;">admin-user.service.ts</span><span style="font-size: 18px; font-family: Arial;">, add it this content:</span></div><div><br /></div><div><br /></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div><div><font style="font-size: 18px;">import { Observable } from 'rxjs';</font></div></div><div><div><font style="font-size: 18px;">import { Injectable } from '@angular/core';</font></div></div><div><div><font style="font-size: 18px;">import { takeUntil } from 'rxjs/operators';</font></div></div><div><div><font style="font-size: 18px;">import { AngularFirestore } from '@angular/fire/firestore';</font></div><div><font style="font-size: 18px;"><br /></font></div></div><div><div><font style="font-size: 18px;">import { User } from '@app/features/models/user';</font></div></div><div><div><font style="font-size: 18px;">import { AngularFireDatabase } from '@angular/fire/database';</font></div></div><div><div><font style="font-size: 18px;">import { SubscriptionService } from '@app/features/firebase/subscription.service';</font></div></div><div><div><font style="font-size: 18px;"><br /></font></div></div><div><font style="font-size: 18px;">@Injectable({</font></div><div><div><font style="font-size: 18px;">providedIn: 'root',</font></div><div><font style="font-size: 18px;"><br /></font></div></div><div><font style="font-size: 18px;">})</font></div><div><div><font style="font-size: 18px;">export class UserService {</font></div><div><font style="font-size: 18px;"><br /></font></div></div><div><font style="font-size: 18px;">    constructor(private firestore: AngularFirestore, private realtime: AngularFireDatabase, private subService: SubscriptionService) {}</font></div><div><div><font style="font-size: 18px;"><br /></font></div></div><div><font style="font-size: 18px;">    // Create</font></div><div><div><font style="font-size: 18px;">    public createUser(user: User) {</font></div></div><div><div><font style="font-size: 18px;">        return this.firestore</font></div><div><font style="font-size: 18px;">        .collection('user')</font></div></div><div><font style="font-size: 18px;">        .doc(user.id)</font></div><div><font style="font-size: 18px;">        .set(user);</font></div><div><font style="font-size: 18px;">    }</font></div><div><div><font style="font-size: 18px;"><br /></font></div></div><div><font style="font-size: 18px;">    // Get Single</font></div><div><div><font style="font-size: 18px;">    public getUser(id: string): Observable&lt;any&gt; {</font></div></div><div><div><font style="font-size: 18px;">        return this.firestore.doc(`user/${id}`).snapshotChanges();</font></div></div><div><font style="font-size: 18px;">    }</font></div><div><div><font style="font-size: 18px;"><br /></font></div></div><div><font style="font-size: 18px;">    // Get List</font></div><div><div><font style="font-size: 18px;">    public getUserList(): Observable&lt;any&gt; {</font></div></div><div><font style="font-size: 18px;">        this.realtime</font></div><div><font style="font-size: 18px;">            .list(`user`)</font></div><div><font style="font-size: 18px;">            .valueChanges()</font></div><div><font style="font-size: 18px;">            .pipe(takeUntil(this.subService.unsubscribe$))</font></div><div><div><font style="font-size: 18px;">            .subscribe(realtimeUsers =&gt; realtimeUsers.map(user =&gt; this.createUser(user as User)));</font></div></div><div><div><font style="font-size: 18px;">        return this.firestore.collection('user').snapshotChanges();</font></div></div><div><font style="font-size: 18px;">    }</font></div><div><div><font style="font-size: 18px;"><br /></font></div></div><div><font style="font-size: 18px;">    // Update</font></div><div><div><font style="font-size: 18px;">    public updateUser(user: User): Promise&lt;void&gt; {</font></div></div><div><div><font style="font-size: 18px;">        return this.firestore.doc(`user/${user.id}`).update({</font></div></div><div><div><font style="font-size: 18px;">            uid: user.uid,</font></div></div><div><div><font style="font-size: 18px;">            displayName: user.displayName,</font></div></div><div><div><font style="font-size: 18px;">            email: user.email,</font></div></div><div><div><font style="font-size: 18px;">            address: user.address,</font></div></div><div><div><font style="font-size: 18px;">            cellphone: user.cellphone,</font></div></div><div><font style="font-size: 18px;">        });</font></div><div><font style="font-size: 18px;">    }</font></div><div><div><font style="font-size: 18px;"><br /></font></div></div><div><font style="font-size: 18px;">    // Delete</font></div><div><div><font style="font-size: 18px;">    public deleteUser(id: string): Promise&lt;void&gt; {</font></div></div><div><div><font style="font-size: 18px;">        return this.firestore.doc(`user/${id}`).delete();</font></div></div><div><font style="font-size: 18px;">    }</font></div><div><font style="font-size: 18px;">}</font></div><div><div><br /></div><div><br /></div></div></div><div><br /></div></en-note>]]></content><created>20200215T124249Z</created><updated>20200317T213700Z</updated><note-attributes><latitude>10.01248168945312</latitude><longitude>-84.18869712297538</longitude><altitude>982.8507080078125</altitude><author>crisarji@gmail.com</author><source>desktop.mac</source><reminder-order>0</reminder-order></note-attributes></note>
</en-export>
